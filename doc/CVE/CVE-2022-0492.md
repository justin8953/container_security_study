# CVE-2022-0492

## 1. CVE Description

A vulnerability was found in the Linux kernelâ€™s cgroup_release_agent_write in the kernel/cgroup/cgroup-v1.c function. This flaw, under certain circumstances, allows the use of the cgroups v1 release_agent feature to escalate privileges and bypass the namespace isolation unexpectedly.

## 2. Concept

 In order to proceed with the exploitation of the vulnerability, the following conditions must be met:

    Container run as root: since only root can modify the release_agent file this is a mandatory condition to exploit the vulnerability
    AppArmor and SELinux must be disabled: both tools prevent the mounting.
    Seccomp must be disabled: only containers running without that can create a new user namespace
    root cgroup v1: which is the more used version in architecture


## 3 Exploitation


## 4. Reference

1.[CVE-2022-0492: Privilege escalation vulnerability causing container escape](https://sysdig.com/blog/detecting-mitigating-cve-2022-0492-sysdig/)

